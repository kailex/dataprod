---
title       : Miles per Gallon Prediction
subtitle    : with a linear model
author      : 
job         : Data Science
framework   : io2012        # {io2012, html5slides, shower, dzslides, ...}
highlighter : highlight.js  # {highlight.js, prettify, highlight}
hitheme     : tomorrow      # 
widgets     : []            # {mathjax, quiz, bootstrap}
mode        : selfcontained # {standalone, draft}
knit        : slidify::knit2slides
---

## Slide 2
### Motor Trend Car Road Tests
The data was extracted from the 1974 Motor Trend US magazine, and comprises fuel consumption and 10 aspects of automobile design and performance for 32 automobiles (1973â€“74 models).
Our goal is to build an application which uses a linear model to predict miles per gallon.
```{r fig.width=10, fig.height=4, echo=FALSE}
data(mtcars)
mtcars[c("cyl","vs","am","gear","carb")] <- lapply(mtcars[c("cyl","vs","am","gear","carb")], as.factor) 
par(mfrow=c(1,2))
boxplot(mpg~as.factor(am), data=mtcars, varwidth=T, names=c("Automatic", "Manual"), xlab="Transmission", ylab="MPG", main="Fig. 1")
hist(mtcars$mpg,breaks=25, xlab="MPG", main="Fig. 2")
```
---

## Slide 3
### Building a linear model
We build a linear model as follows:
```{r echo=TRUE, results='hide'}
lm1 <- lm(mpg~.-1, data=mtcars)
```
We use AIC-based stepwise algorithm to decrease the number of predictive variables in the model to reduce complexity.
```{r echo=TRUE, results='hide'}
lmAIC <- step(lm1)
```
The final model with the AIC score of 61.31 is next:
```{r echo=TRUE,results='hide'}
lm2 <- lm(mpg~wt+qsec+am-1, data=mtcars)
```
---
## Slide 4
### Shiny application for prediction miles per gallon
A shiny application consists of two parts: a user interface and a server side. A user interface of a shiny app allows us to input a weight, 1/4 mile time and choose a type of a transmission. A server side builds a linear model based on input values. This results in reactive displaying of two plots which show a predicted MPD with confidence interval.

---

## Slide 5
### Resulting Plot with Predicted MPD

```{r echo=FALSE}
mpg <- round(predict(lm2, data.frame(wt=mean(mtcars$wt), 
                                     qsec=mean(mtcars$qsec), 
                                     am=factor(0)), interval="predict"), 2) 
par(mfrow=c(1,2))
  
plot(mtcars$wt, mtcars$mpg, col=c("blue", "green"),
     main=paste0("Predicted MPG is ", mpg[1]),
     xlab="Weight", ylab="MPG")
lines(x=c(mean(mtcars$wt),mean(mtcars$wt)), y=c(mpg[2], mpg[3]), lty = "dotted", col="red", lwd=3)
points(mean(mtcars$wt), mpg[1], col="red", cex=1.5, pch=10)
grid(col="lightgray", lty="dotted",  lwd=par("lwd"), equilogs=F)
legend("topright", c("Automatic","Manual"), 
       title="Transmission",
       lty=c(1,1), lwd=c(2,2), col=c("blue", "green"))

plot(mtcars$qsec, mtcars$mpg, col=c("blue", "green"), 
     xlab="1/4 mile time", ylab="MPG")
lines(x=c(mean(mtcars$qsec),mean(mtcars$qsec)), y=c(mpg[2], mpg[3]), lty = "dotted", col="red", lwd=3)
points(mean(mtcars$qsec), mpg[1], col="red", cex=1.5, pch=10)
grid(col="lightgray", lty="dotted",  lwd=par("lwd"), equilogs=T)
```
